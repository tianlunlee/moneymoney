<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Finances</title>
  </head>
  <style>
  html {
    background-image: url(/images/back.jpg);

  }
  body{

    width:80%;
    height: inherit;
    margin-left: 10%;
    font-family: sans-serif;
    background: rgba(255, 255, 255, 0.3);

    margin-top: auto;
    padding-left: .1%;
    padding-right: .1%;
    padding-top: .5%;
    padding-bottom: 5%;


  }
  #header {
    width: 100%;
    margin-top: -2%;
    padding-top: 1%;
    background: rgba(192, 192, 192, 0.5);

  }
  #logo{
    padding-top: 0px;
    padding-left: 10px;
    padding-bottom: 0;
  }
  #logo_text{
    font-size: 20px;

    font-family: sans-serif;
    text-decoration: none;
  }
  #logo_image{
    width: 40px;
    height: 40px;
    padding-right: 5px;

  }
  #out {



    float:right;

    background-color: red;

  }

    ul {
      list-style-type: none;
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: gray;
    }

    li {
      float: left;
    }

    li a {
      display: block;
      color: white;
      text-align: center;
      padding: 14px 16px;
      text-decoration: none;
    }

    a:hover:not(.active) {
      background-color: #111;
    }

    .active {
      background-color:#4CAF50;
    }
    #title {
      background-color: black;
      text-align: center;
      font-size: 40px;
      -webkit-background-clip: text;
      -moz-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: rgba(192,192,192,0.2) 0px 3px 3px;
    }

    #first_table{
      text-align: center;
      margin-left: 13%;

    }
    #current_budget{
      font-size: 25px;
      font-weight: bold;
      text-align: center;
      padding-bottom: -5%;
    }
    #hello {
      margin-left: 5%;

    }
    #add_button{
      background-color: white;
      font-size: 13px;
      font-weight: bold;
      border: 2px solid lightgray;
      width: 100px;
      color: red;

    }
    #add_button:hover{

      background-color: gray;
      color: white;
    }

    #first_row{
      border: 2px solid black;

    }
    #bottom {
      margin-left: 25%;

    }
    #top_date{
      margin-left: 32%;
      margin-right: 32%;
    }
    #b_name{
      font-weight: normal;
      font-size: 20px;


    }
    .name{
      display: inline-block;
      font-size: 20px;
    }
    #planned_title{

      display: inline-block;
      margin-left: -20%;
    }
    #actual_title{
      display: inline-block;
      margin-left: -30%;
      margin-right: 1%;
    }
    #left_over{
      color: white;

    }
    #left_over_amount{
      font-size: 20px;
    }
    #info_table {
      border: 3px solid black;
      border-bottom: none;
      width: 105%;
      margin-left: -10%;


    }

    .info_th {
      border-right: 2px solid black;
      background: rgba(192, 192, 192, 0.5);

    }

    .info_td {
      border-top: 2px solid black;
      border-right: 2px solid black;
      border-bottom: 2px solid black;
    }
    #add_box{
      border-top: none;
      border-right: none;

    }
    tr{
      border-right: 2px solid black;

    }
    input{
      width: 80%;
      height: 55%;

    }
    #out:hover{
      background-color: darkred;

    }
    #home:hover{
      background-color: darkgreen;
    }
    #tip{
      text-align: center;
      margin-top: 5%;

    }
    #tip_img{
      width: 560px;
      height: 370px;
      margin-left: 19%;
      padding: 5px 5px 5px 5px;
    }
    #heade{

      text-align: center;

    }
    #vid{
      margin-top: 5%;
      background: rgba(255, 255, 255, 1);
      width: 80%;
      margin-left: 10%;
      margin-right: 10%;
      padding-bottom: 5%;
      padding-top: 3%;

    }
    #white{
      margin-top: 0%;
      background: rgba(255, 255, 255, 1);
      width: 80%;
      margin-left: 10%;
      margin-right: 10%;
      padding-bottom: 5%;
      padding-top: 3%;
    }
    #balance{
      margin-left: -20%;
    }


  </style>

  <body>


    <div id="header">

        <h1 id="logo_text"><img src="/images/logo.png" id="logo_image"></img>College Student Finances</h1>
        <ul>
          <li><a class="active" href="/" id="home">Home</a></li>
          <li><a href="/addbudget">Create New Budget</a></li>
          <li><a href="/budgets">View Previous Budgets</a></li>
          <li><a href="{{user.history_url()}}">View All History</a></li>
          <li style="float: right"><form action="/"><a class="button" id="out" href="{{logout_url}}">Log Out</a></form></li>
        </ul>

    </div>
    <!-- {{user.name}}'s Finances -->
    <h1 id="title">Finances</h1>

  <script>{{script}}</script>


    <h3 id="hello"> Hello {{user.username}},</h3>
  <div id="center_all">
    <table id="top_date">
      <tr>
      <th>
      <div class="name" id="b_name">Budget Name:</div>
      {% if budgets[0] %}
      <div class="name">{{budgets[0].source_name}}</div>
      {% else %}
      <div class="name">No Budget!</div>

      {% endif %}
      <br>
      <br>

      </th>
      </tr>



      <tr>

      <th>
      <div class="name" id="b_name">Start Date:</div>
      {% if budgets[0] %}
      <div class="name" style="margin-right: 9px;">{{budgets[0].date}}</div>
      {% else %}
      <div class="name">No Budget!</div>
      {% endif %}

      <div class="name" id="b_name">End Date:</div>
      {% if budgets[0] %}
      <div class="name">{{budgets[0].end_date}}</div>
      {% else %}
      <div class="name">No Budget!</div>
      {% endif %}
      </th>
      </tr>

    </table>

    <br>
    {% if countdown.days<=0 %}
    <h2 style="text-align: center; align-items: center; color:red"> Please create a new budget.<br>
    {% else %}
    <h2 style="text-align: center; align-items: center;">
    {% endif %}
    {{countdown.days}} Day(s) Remaining</h2>

    <br>
    <br>
<div id="white">
    <div id="current_budget">
    Your Set Budget:
    {% if budgets[0] %}
      ${{budgets[0].amount}}
    {% else %}
      No Budget!
    {% endif %}
    </div>

    <br>
    <br>



  <div id="first_table">
  <body class="center">

    <div>
      <form action='/' method='post'>
        <table width="90%" id="info_table">
        <div >
          <tr id="first_row">
            <th class="info_th" >Note: </th>
            <th class="info_th" >Item/Service: </th>
            <th class="info_th" >Cost: </th>
            <th class="info_th" >New Balance: </th>
          </tr>
        </div>
          <tr>
            <td class="info_td">
              <input name='note' placeholder='eg. date' required>
            </td>
            <td class="info_td">
              <input name='name' placeholder='Item/Service eg.Rent, Bills' required>
            </td>
            <td class="info_td">
              <input name='cost' placeholder='Cost' type="number" step='0.01' required>
            </td>
            <td class="info_td">
            </td>
            <td class="info_td" id="add_box">

              <p><input type="submit" value="Add" id="add_button"> </p>

            </td>
          </tr>
        </form>
          {% for i in range(0,5) %}

              {% if items[i] %}
                {% if i%2==0 %}
                  <tr style="background-color:lightgray">
                {% else %}
                  <tr>
                {% endif %}
                    <td>{{items[i].note}}</td>
                    <td>{{items[i].item_name}}</td>
                    <td>${{items[i].cost}}</td>
                  {% if items[i].remaining_balance/budgets[0].amount <= 0.2 %}
                    <td style="color:red">
                  {% elif items[i].remaining_balance/budgets[0].amount <= 0.5 %}
                    <td style="color:orange">
                  {% else %}
                    <td>
                  {% endif %}
                      ${{items[i].remaining_balance}}</td>
                    <form action='/delete?key={{items[i].key.urlsafe()}}' method='post'>
                    <td><input type="submit" name="key" value="Delete"></td>
                    </form>

              {% endif %}
              {% endfor %}
            </tr>
        </table>
    </div>
  </div>
    <br>
    <br>
    <div id="bottom">
      <table class = "budget" >
        <tr>

          <td class = "bottom_part">
            <div id="actual_title">
              <div class="name" id="b_name"><b>Total Amount Spent:</b></div>
            </div>


            {% if budgets[0] and items[0] %}
            <div class="name"> ${{budgets[0].amount - items[0].remaining_balance}}</div>
            {% else %}
            <div class="name">Nothing Spent!</div>
            {% endif %}

          </td>


            <td class="name">

            <b class="name" id="balance">Balance Left Over:</b>

            {% if budgets[0] and items[0] %}

              {% if items[0].remaining_balance/budgets[0].amount <= 0.2 %}
                <div class="name" style="color:red">
              {% elif items[0].remaining_balance/budgets[0].amount <= 0.5 %}
                </div>
                <div class="name" style="color:orange">
              {% else %}
                </div>
                <div class="name">
              {% endif %}
                  ${{items[0].remaining_balance}}</div>
            {% else %}
              <div class="name">Nothing Spent!</div>
            {% endif %}
            </td>




        </tr>
      </table>
    </div>
</div>
  <div id="vid">
    <h2 id='heade'>Tip Of The Week</h2>
    <h4 id="heade"></h4>
    <img id="tip_img" src="/images/financial.jpg" ></img>
  </div>



  </body>

</html>
